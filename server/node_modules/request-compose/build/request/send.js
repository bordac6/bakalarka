'use strict';

var http = require('http');
var https = require('https');
var log = require('../log');

module.exports = function () {
  return function (_ref) {
    var options = _ref.options,
        body = _ref.body;
    return new Promise(function (resolve, reject) {

      var req = (/https/.test(options.protocol) ? https : http).request(options).on('response', function (res) {
        log({ res });
        resolve({ res });
      }).on('error', reject);

      req.end(body);

      log({ req, body, options });
    });
  };
};